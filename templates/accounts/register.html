{% extends 'base.html' %}

{% block title %}Sign Up - HaradaFlow{% endblock %}

{% block content %}
<div class="max-w-md mx-auto bg-white dark:bg-slate-800 rounded-lg shadow-md p-8">
    <h2 class="text-2xl font-bold mb-6">Create Account</h2>
    <div id="sign-up"></div>
    
    <p class="mt-4 text-center text-sm">
        Already have an account? <a href="/sign-in" class="text-blue-600 hover:underline">Sign in</a>
    </p>
</div>

<script>
    window.addEventListener('load', async () => {
        const clerk = window.Clerk;
        
        if (clerk) {
            await clerk.load();
            
            // Get redirect URL from query parameters
            const urlParams = new URLSearchParams(window.location.search);
            const redirectUrl = urlParams.get('redirect') || '/dashboard';
            
            if (clerk.user) {
                // Already signed in, redirect to dashboard or saved URL
                window.location.href = redirectUrl;
            } else {
                // Mount SignUp component with redirect after signup
                clerk.mountSignUp(document.getElementById('sign-up'), {
                    afterSignUpUrl: redirectUrl,
                    signInUrl: '/sign-in'
                });
            }
        }
    });
</script>
{% endblock %}
